<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
		<meta name="description" content="Blockchain Media Distribution">
		<meta name="keywords" content="Blockchain Media Distribution, Blockchain, Media, Distribution, Alexandria, Bitcoin, Florincoin, Decentralized, P2P, FLO, BTC, Free, Video, Publisher">
		<title>ΛLΞXΛNDRIΛ Publisher</title>
		
		<!-- Application styles-->
		<link rel="stylesheet" href="./css/bootstrap.min.css">
		<link rel="stylesheet" href="./css/entypo.css">
		<link rel="stylesheet" href="./css/font-awesome.css">
		<link href="./css/sweet-alert.css" rel="stylesheet">

		<style type="text/css">
			.al-dark-logo {
				filter: invert(60%);
			}
			@media (max-width: 450px) { 
				.al-dark-logo {
					height: auto;
					max-height: 50px;
					width: 100%;
				}
			}
			@media (min-width: 450px) and (max-width: 500px) { 
				.al-dark-logo {
					height: auto;
					max-height: 60px;
					width: 100%;
				}
			}
			@media (min-width: 500px) and (max-width: 550px) { 
				.al-dark-logo {
					height: auto;
					max-height: 60px;
					width: 100%;
				}
			}
			@media (min-width: 550px) and (max-width: 600px) { 
				.al-dark-logo {
					height: auto;
					max-height: 70px;
					width: 100%;
				}
			}
			@media (min-width: 601px) { 
				.al-dark-logo {
					max-height: 70px;
					width: 600px;
				}
			}
			.colorgraph {
				height: 5px;
				border-top: 0;
				background: #c4e17f;
				border-radius: 5px;
				background-image: -webkit-linear-gradient(left, #c4e17f, #c4e17f 12.5%, #f7fdca 12.5%, #f7fdca 25%, #fecf71 25%, #fecf71 37.5%, #f0776c 37.5%, #f0776c 50%, #db9dbe 50%, #db9dbe 62.5%, #c49cde 62.5%, #c49cde 75%, #669ae1 75%, #669ae1 87.5%, #62c2e4 87.5%, #62c2e4);
				background-image: -moz-linear-gradient(left, #c4e17f, #c4e17f 12.5%, #f7fdca 12.5%, #f7fdca 25%, #fecf71 25%, #fecf71 37.5%, #f0776c 37.5%, #f0776c 50%, #db9dbe 50%, #db9dbe 62.5%, #c49cde 62.5%, #c49cde 75%, #669ae1 75%, #669ae1 87.5%, #62c2e4 87.5%, #62c2e4);
				background-image: -o-linear-gradient(left, #c4e17f, #c4e17f 12.5%, #f7fdca 12.5%, #f7fdca 25%, #fecf71 25%, #fecf71 37.5%, #f0776c 37.5%, #f0776c 50%, #db9dbe 50%, #db9dbe 62.5%, #c49cde 62.5%, #c49cde 75%, #669ae1 75%, #669ae1 87.5%, #62c2e4 87.5%, #62c2e4);
				background-image: linear-gradient(to right, #c4e17f, #c4e17f 12.5%, #f7fdca 12.5%, #f7fdca 25%, #fecf71 25%, #fecf71 37.5%, #f0776c 37.5%, #f0776c 50%, #db9dbe 50%, #db9dbe 62.5%, #c49cde 62.5%, #c49cde 75%, #669ae1 75%, #669ae1 87.5%, #62c2e4 87.5%, #62c2e4);
			}

			.warning-feedback {
				color: #ffc107 !important;
			}

			.has-warning {
				border-color: #ffc107;
			}
			.has-warning:focus {
				border-color: #ffc107;
			}
		</style>
	</head>
	<body class="bg-light" style="height: 55vh;">
		<div class="container" style="margin-top: 60px; height: 100%;">
			<div class="row justify-content-center" style="margin-top:20px; height: 100%;">
			<img src="./img/logo-long.png" class="al-dark-logo">
			    <div class="col-12 col-sm-8 col-md-6 col-lg-6 col-xl-6 col-sm-offset-2 col-md-offset-3 col-lg-offset-3 col-xl-offset-3 align-content-center align-self-center">
			    	<div style="height: 50px;"></div>
					<h2>Please Register <small style="font-size: 16px;padding-left:20px">It's free and always will be.</small></h2>
					<hr class="colorgraph">
					<div class="form-group">
						<input type="text" name="username" id="username" class="form-control input-lg" placeholder="Username*" tabindex="1" oninput="checkUsername()">
						<div class="invalid-feedback" id="feedback_username">
							Please provide a Username.
						</div>
					</div>
					<div class="form-group">
						<input type="email" name="email" id="email" class="form-control input-lg" placeholder="Email Address" tabindex="2" oninput="checkEmail()">
						<div class="invalid-feedback" id="feedback_email">
							Email is invalid or is already in use, please choose another one.
						</div>
					</div>
					<div class="row">
						<div class="col-xs-12 col-sm-6 col-md-6">
							<div class="form-group">
								<input type="password" name="password" id="password" class="form-control input-lg" placeholder="Password*" tabindex="3" oninput="checkPassword()">
								<div class="warning-feedback" id="passwordValidation" style="display:none">
									We suggest your password contain a minimum of:
									<ul>
										<li id="pwval-eight"><span class="icon icon-cross"></span> 8 Characters</li>
										<li id="pwval-upper"><span class="icon icon-cross"></span> 1 Uppercase Letter</li>
										<li id="pwval-lower"><span class="icon icon-cross"></span> 1 Lowercase Letter</li>
										<li id="pwval-number"><span class="icon icon-cross"></span> 1 Number</li>
										<li id="pwval-sc"><span class="icon icon-cross"></span> 1 Special Character</li>
									</ul>
								</div>
							</div>
						</div>
						<div class="col-xs-12 col-sm-6 col-md-6">
							<div class="form-group">
								<input type="password" name="password_confirmation" id="password_confirmation" class="form-control input-lg" placeholder="Confirm Password*" tabindex="4" oninput="checkPassword()">
								<div class="invalid-feedback" id="feedback_password_confirmation">
									Passwords must match
								</div>
							</div>
						</div>
					</div>
					<div class="row">
						<!-- <div class="col-xs-4 col-sm-3 col-md-3">
							<span class="button-checkbox">
								<button type="button" class="btn" data-color="primary" tabindex="7">I Agree</button>
		                        <input type="checkbox" name="t_and_c" id="t_and_c" class="d-none" value="1">
							</span>
						</div> -->
						<div class="col-12" style="font-size: 13.5px;">
							By <strong>Registering</strong>, you agree to the <a href="#" data-toggle="modal" data-target="#t_and_c_m">Terms and Conditions</a>, including our Cookie Use.
						</div>
					</div>
					<div class="row">
						<div class="g-recaptcha" data-sitekey="6LdpKBYUAAAAACnfrr-0wEfMrLXURVs-pV5vhvM_" style="margin: 0px auto;margin-top:10px;margin-bottom:-5px;"></div>
					</div>
					<hr class="colorgraph">
					<div class="row">
						<div class="col-xs-12 col-md-3"><a href="login.html" class="btn btn-success btn-block btn-lg">Sign In</a></div>
						<div class="col-xs-12 col-md-9"><button id="register" class="btn btn-primary btn-block btn-lg" onClick="onRegisterClick();" tabindex="5">Register</button></div>
					</div>
				</div>
			</div>
		</div>

		<!-- Load external JS helper files -->
		<script src="./js/jquery-3.2.1.min.js"></script>
		<script src="./js/tether.min.js"></script>
		<script src="./js/underscore.js"></script>
		<script src="./js/popper.min.js"></script>
		<script src="./js/bootstrap.min.js"></script>
		<script src="./js/backbone-min.js"></script>
		<script src="https://www.google.com/recaptcha/api.js" async defer></script>
		<script src="https://cdn.ravenjs.com/3.17.0/raven.min.js" crossorigin="anonymous"></script>
		<script type="text/javascript">
			(function() { var s = document.createElement("script"); s.type = "text/javascript"; s.async = true; s.src = '//api.usersnap.com/load/14a5209d-6d3f-4699-8832-5f709e647ba0.js';
			var x = document.getElementsByTagName('script')[0]; x.parentNode.insertBefore(s, x); })();
		</script>
		<!-- Load Dependencies JS -->
		<script src="./js/SimpleDeps.js"></script>
		<script src="./js/SimpleWallet.js"></script>
		<script src="./js/libraryd-js.js"></script>
		<script src="./js/sweet-alert.min.js"></script>
		<!-- Load Phoenix -->
		<script src="./js/phoenix-api.js"></script>
		<script src="./js/phoenix-ui.js"></script>

		<script type="text/javascript">
			Raven.config('https://c06e40d616e2425db7d419113c957b6a@sentry.io/207690').install()

			var onRegisterClick = function(){
				var username = $('#username').val();
				var password = $('#password').val();
				var email = $('#email').val();

				if (checkUsername()){
					if (checkPassword()){
						checkEmail(function(isTaken){
							if (!isTaken){
								setRegisterText();
								Phoenix.register(username, password, email);
							}
						})
					}
				}
			}

			var resetRegisterText = function(){
				document.getElementById('register').innerHTML = 'Register';
			}

			var setRegisterText = function(){
				document.getElementById('register').innerHTML = '<i class="fa fa-circle-o-notch fa-spin"></i> Loading';
			}

			PhoenixEvents.on("onWalletCreateFail", function(msg){ 
				resetRegisterText();
				swal({
					type: "error",
					title: "Wallet Creation Error",
					text: "Please try again"
				});
			});
			PhoenixEvents.on("onPublisherAnnounceFail", function(msg){ 
				resetRegisterText();
				swal({
					type: "error",
					title: "Publisher Announce Error",
					text: "Please try again"
				});
			});
			PhoenixEvents.on("onFaucetFail", function(msg){ 
				resetRegisterText();
				swal({
					type: "error",
					title: "Florincoin Faucet Error",
					text: msg.message + " Please try again later!"
				});
			});
			PhoenixEvents.on("reCAPTCHAFail", function(msg){ 
				resetRegisterText();
				swal({
					type: "error",
					title: "reCAPTCHA Error",
					text: "Please try again"
				});
			});
			PhoenixEvents.on("onPublisherAnnounceSuccess", function(msg){ 
				if (msg.email && msg.email != ""){
					document.location.href = "index.html"
				} else {
					swal({
						title: "Register Successful",
						type: "success",
						text: "Your identifier is " + msg.identifier + ", please save this to Login with",
						showCloseButton: true
					}, function () { 
						document.location.href = "index.html"; 
					});
				}
			});

			var checkUsername = function(){
				var username = $('#username').val();

				if (username === ""){
					$('#username').removeClass('is-valid');
					$('#username').addClass('is-invalid');

					$('#feedback_username').show();

					return false;
				} else {
					$('#username').removeClass('is-invalid');
					$('#username').addClass('is-valid');

					$('#feedback_username').hide();

					return true;
				}
			}

			var checkPassword = function(){
				var password = $('#password').val();
				var password_confirmation = $('#password_confirmation').val();

				var uppercase = false;
				var lowercase = false;
				var number = false;
				var specialCharacter = false;
				var atLeastEight = false;

				function hasDigit(str) {
					return (/^(?=.*\d)/.test(str));
				}

				function hasLowerCase(str) {
					return (/^(?=.*[a-z])/.test(str));
				}

				function hasUpperCase(str) {
					return (/^(?=.*[A-Z])/.test(str));
				}

				function hasSpecialCharacter(str) {
					return (/[^A-Za-z0-9]/.test(str));
				}

				function isAtLeastEight(str){
					return str.length >= 8;
				}

				var warningColor = "#ffc107";
				var successColor = "#28a745";

				if (hasDigit(password)){
					number = true;
					document.getElementById('pwval-number').innerHTML = '<span class="icon icon-check"></span> 1 Number';
					document.getElementById('pwval-number').style.color = successColor;
				} else {
					document.getElementById('pwval-number').innerHTML = '<span class="icon icon-cross"></span> 1 Number';
					document.getElementById('pwval-number').style.color = warningColor;
				}

				if (hasLowerCase(password)){
					lowercase = true;
					document.getElementById('pwval-lower').innerHTML = '<span class="icon icon-check"></span> 1 Lowercase Letter';
					document.getElementById('pwval-lower').style.color = successColor;
				} else {
					document.getElementById('pwval-lower').innerHTML = '<span class="icon icon-cross"></span> 1 Lowercase Letter';
					document.getElementById('pwval-lower').style.color = warningColor;
				}

				if (hasUpperCase(password)){
					uppercase = true;
					document.getElementById('pwval-upper').innerHTML = '<span class="icon icon-check"></span> 1 Uppercase Letter';
					document.getElementById('pwval-upper').style.color = successColor;
				} else {
					document.getElementById('pwval-upper').innerHTML = '<span class="icon icon-cross"></span> 1 Uppercase Letter';
					document.getElementById('pwval-upper').style.color = warningColor;
				}

				if (hasSpecialCharacter(password)){
					specialCharacter = true;
					document.getElementById('pwval-sc').innerHTML = '<span class="icon icon-check"></span> 1 Special Character';
					document.getElementById('pwval-sc').style.color = successColor;
				} else {
					document.getElementById('pwval-sc').innerHTML = '<span class="icon icon-cross"></span> 1 Special Character';
					document.getElementById('pwval-sc').style.color = warningColor;
				}

				if (isAtLeastEight(password)){
					atLeastEight = true;
					document.getElementById('pwval-eight').innerHTML = '<span class="icon icon-check"></span> 8 Characters';
					document.getElementById('pwval-eight').style.color = successColor;
				} else {
					document.getElementById('pwval-eight').innerHTML = '<span class="icon icon-cross"></span> 8 Characters';
					document.getElementById('pwval-eight').style.color = warningColor;
				}

				if (!number || !lowercase || !uppercase || !specialCharacter || !atLeastEight){
					$('#passwordValidation').show();

					$('#password').addClass('has-warning');
					$('#password').removeClass('is-valid');
					$('#password').removeClass('is-invalid');
				} else {
					$('#passwordValidation').hide();

					$('#password').addClass('is-valid');
					$('#password').removeClass('has-warning');
					$('#password').removeClass('is-invalid');
				}
				
				if (password === "")
					return false;

				if (password_confirmation === ""){
					$('#password_confirmation').removeClass('is-valid');
					$('#password_confirmation').addClass('is-invalid');

					return false;
				}

				if (password === password_confirmation){
					$('#password').removeClass('has-warning');
					$('#password').removeClass('is-invalid');
					$('#password').addClass('is-valid');

					$('#password_confirmation').removeClass('is-invalid');
					$('#password_confirmation').addClass('is-valid');

					$('#feedback_password_confirmation').hide();

					return true;
				} else {
					$('#password_confirmation').removeClass('is-valid');
					$('#password_confirmation').addClass('is-invalid');

					$('#feedback_password_confirmation').show();
					return false;
				}
			}

			var checkEmail = function(callback){
				if (!callback)
					callback = function(){}
				
				var email = $('#email').val();

				if (!email || email === ""){
					callback(false);
					return;
				}

				Phoenix.checkEmail(email, function(isTaken){
					if (isTaken){
						$('#email').removeClass('is-valid');
						$('#email').addClass('is-invalid');

						$('#feedback_email').show();
					} else {
						$('#email').removeClass('is-invalid');
						$('#email').addClass('is-valid');

						$('#feedback_email').hide();
					}
					callback(isTaken);
				})
			}

			$(function(){
				$('.button-checkbox').each(function(){
					var $widget = $(this),
						$button = $widget.find('button'),
						$checkbox = $widget.find('input:checkbox'),
						color = $button.data('color'),
						settings = {
								on: {
									icon: 'fa fa-check-square-o'
								},
								off: {
									icon: 'fa fa-square-o'
								}
						};

					$button.on('click', function () {
						$checkbox.prop('checked', !$checkbox.is(':checked'));
						$checkbox.triggerHandler('change');
						updateDisplay();
					});

					$checkbox.on('change', function () {
						updateDisplay();
					});

					function updateDisplay() {
						var isChecked = $checkbox.is(':checked');
						// Set the button's state
						$button.data('state', (isChecked) ? "on" : "off");

						// Set the button's icon
						$button.find('.state-icon')
							.removeClass()
							.addClass('state-icon ' + settings[$button.data('state')].icon);

						// Update the button's color
						if (isChecked) {
							$button
								.removeClass('btn-outline-primary')
								.addClass('btn-' + color + ' active');
						}
						else
						{
							$button
								.removeClass('btn-' + color + ' active')
								.addClass('btn-outline-primary');
						}
					}
					function init() {
						updateDisplay();
						// Inject the icon if applicable
						if ($button.find('.state-icon').length == 0) {
							$button.prepend('<i class="state-icon ' + settings[$button.data('state')].icon + '"></i> ');
						}
					}
					init();
				});
			});
		</script>
	</body>
</html>