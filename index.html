<html lang="en"><head>
    <meta charset="utf-8">
    <meta name="robots" content="noindex">

    <title>DLOA - Publisher</title>
        <meta name="viewport" content="width=device-width, initial-scale=1">
    <link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.0/css/bootstrap.min.css" rel="stylesheet" id="bootstrap-css">

    <!-- Load css files -->
    <link href="./css/main.css" rel="stylesheet">
    <link href="./css/artifact.css" rel="stylesheet">
    <link href="./css/sweet-alert.css" rel="stylesheet">
</head>
<body>
	<div class="container">
	<div class="row">
		<section>
        <center>
            <h1>The Decentralized Library of Alexandria</h1>
            <h2>~ Video Publisher ~</h2>
        </center>
        <div class="wizard">
            <div class="wizard-inner">
                <div class="connecting-line"></div>
                <ul class="nav nav-tabs" role="tablist">

                    <li role="presentation" class="active">
                        <a href="#step1" data-toggle="tab" aria-controls="step1" role="tab" title="" data-original-title="Publisher">
                            <span class="round-tab">
                                <i class="glyphicon glyphicon-user line-height-hack"></i>
                            </span>
                        </a>
                    </li>

                    <li role="presentation" class="disabled">
                        <a href="#step2" data-toggle="tab" aria-controls="step2" role="tab" title="" data-original-title="Artifact">
                            <span class="round-tab">
                                <i class="glyphicon glyphicon-film line-height-hack"></i>
                            </span>
                        </a>
                    </li>
                    <li role="presentation" class="disabled">
                        <a href="#step3" data-toggle="tab" aria-controls="step3" role="tab" title="" data-original-title="Publish">
                            <span class="round-tab">
                                <i class="glyphicon glyphicon-refresh line-height-hack"></i>
                            </span>
                        </a>
                    </li>

                    <li role="presentation" class="disabled">
                        <a href="#complete" data-toggle="tab" aria-controls="complete" role="tab" title="" data-original-title="Complete">
                            <span class="round-tab">
                                <i class="glyphicon glyphicon-ok line-height-hack"></i>
                            </span>
                        </a>
                    </li>
                </ul>
            </div>

            <form role="form" lpformnum="1">
                <div class="tab-content">
                    <div class="tab-pane active" role="tabpanel" id="step1">
                        <h3>Step 1</h3>
                        <p>Select/Create your Publisher ID</p>
                        <div class="col-lg-10 col-lg-offset-2">
                        <form class="form-horizontal">
                            <div class="form-group">
                                <label for="inputEmail3" class="col-sm-2 control-label">Select Publisher ID</label>
                                <div class="col-sm-6">
                                    <select id="publisherSelect" class="form-control">
                                        <option>None Registered...</option>
                                    </select>
                                </div>
                            </div>
                            <br>
                            <br>
                            <div class="form-group">
                                <div class="col-sm-offset-2 col-sm-6 form-inline">
                                    <button type="button" data-toggle="modal" data-target="#newPublisherModal" class="btn btn-default">Register New</button>
                                    <button type="button" onclick="continueToArtifact();" class="btn btn-success pull-right">Continue</button>
                                </div>
                            </div>
                        </form>
                        </div>
                    </div>
                    <div class="tab-pane" role="tabpanel" id="step2">
                        <div class="section publish col-lg-12">
                            <div class="publish-section information">
                            <form>
                                <div class="row">
                                    <div class="col-sm-8">
                                       <h5>Video Information</h5>
                                            <div class="form-group">
                                                <input type="text" class="form-control" id="videoTitle" placeholder="Video Title">
                                            </div>
                                            <div class="form-group">
                                                <input type="text" class="form-control" id="directorName" placeholder="Director Name">
                                            </div>
                                            <div class="form-group">
                                                <input type="text" class="form-control" id="distributor" placeholder="Distributor">
                                            </div>
                                            <div class="form-group">
                                                <input type="date" class="form-control" id="releaseYear" placeholder="Release Year">
                                            </div>
                                            <div class="form-group">
                                                <textarea row="3" class="form-control" id="description" placeholder="Video Description"></textarea>
                                            </div>
                                    </div>
                                    <div class="col-sm-4">
                                        <h5>Poster Image</h5>
                                        <div id="poster" class="cover-art">
                                            <p id="posterText">Poster Image</p>
                                        </div>
                                        <input type="file" name="posterFile" id="posterFile">
                                    </div>
                                </div>
                            </div>
                           <div class="publish-section publish-pricing">
                                <div class="row">
                                    <div class="col-sm-10">
                                        <p class="small">Pick the price for your video. You are allowed to enter up to one tenth of a cent.</p>
                                    </div>
                                </div>
                                <div class="row">
                                   <div class="col col-sm-6">
                                        <h5>Price to Play</h5>
                                        <form class="form-horizontal">
                                            <div class="form-group" style="margin-bottom: 65px">
                                                <label for="" class="col-sm-5 control-label">Suggested:</label>
                                                <div class="col-sm-7">
                                                    <div class="input-group">
                                                        <div class="input-group-addon">$</div>
                                                        <input type="text" class="form-control" id="suggestedPlay" placeholder="0.000">
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="form-group">
                                                <label for="" class="col-sm-5 control-label">Minimum:</label>
                                                <div class="col-sm-7">
                                                    <div class="input-group">
                                                        <div class="input-group-addon">$</div>
                                                        <input type="text" class="form-control" id="minPlay" placeholder="0.000">
                                                    </div>
                                                </div>
                                            </div>
                                        </form>
                                    </div>
                                   <div class="col col-sm-6">
                                        <h5>Price to Purchase</h5>
                                        <form class="form-horizontal">
                                            <div class="form-group">
                                                <label for="" class="col-sm-5 control-label">Suggested:</label>
                                                <div class="col-sm-7">
                                                    <div class="input-group">
                                                        <div class="input-group-addon">$</div>
                                                        <input type="text" class="form-control" id="suggestedBuy" placeholder="0.000">
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="form-group">
                                                <label for="" class="col-sm-5 control-label">Minimum:</label>
                                                <div class="col-sm-7">
                                                    <div class="input-group">
                                                        <div class="input-group-addon">$</div>
                                                        <input type="text" class="form-control" id="minBuy" placeholder="0.000">
                                                    </div>
                                                </div>
                                            </div>
                                        </form>
                                    </div>
                                </div>
                            </div>
                           <div class="publish-section">
                                <div class="publish-files audio-tracks">
                                    <h5>
                                        <object type="image/svg+xml" data="assets/svg/media-16px-2_note-03.svg"></object>
                                        Video Files</h5>
                                    <!--<table class="table" id='mediaTable'>
                                        <colgroup>
                                            <col class="">
                                            <col class="">
                                            <col style="width: 75px;">
                                            <col style="width: 75px;">
                                            <col style="width: 75px;">
                                            <col class="">
                                        </colgroup>
                                        <thead>
                                            <tr>
                                                <th>File</th>
                                                <th>File Name</th>
                                                <th>File Size</th>
                                                <th>Duration</th>
                                                <th>Track</th>
                                                <th>Display name</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <tr>
                                                <td>1</td>
                                                <td>dj_day.flac</td>
                                                <td>3.5 MB</td>
                                                <td>3:27 min</td>
                                                <td><input type="text" class="form-control" value="1"></td>
                                                <td><input type="text" class="form-control" value="DJ Day"></td>
                                            </tr>
                                        </tbody>
                                    </table>-->
                                    <!-- Upload effect is on CSS :hover state, make it for drag & drop only -->
                                    <input type="file" name="mediaFiles" id="mediaFiles" multiple></input>
                                </div>
                            </div>
                           <div class="publish-section">
                                <div class="publish-files extra-files">
                                    <h5>
                                        <object type="image/svg+xml" data="assets/svg/files-16px_single-folded-content.svg"></object>
                                        Extra Files
                                    </h5>
                                    <!--<table class="table" id="extraTable">
                                        <colgroup>
                                            <col class="">
                                            <col class="">
                                            <col style="width: 125px;">
                                            <col class="">
                                        </colgroup>
                                        <thead>
                                            <tr>
                                                <th>File</th>
                                                <th>File Name</th>
                                                <th>File Type</th>
                                                <th>Display name</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <tr>
                                                <td>1</td>
                                                <td>dj_day.flac</td>
                                                <td>
                                                    <select class="form-control" id="sel1">
                                                        <option>Artwork</option>
                                                        <option>Zip File</option>
                                                        <option>Thingy</option>
                                                        <option>Luigi was not here</option>
                                                    </select>
                                                </td>
                                                <td><input type="text" class="form-control" value="DJ Day"></td>
                                            </tr>
                                            <tr>
                                                <td>2</td>
                                                <td>i_digress.flac</td>
                                                <td>
                                                    <select class="form-control" id="sel1">
                                                        <option>Artwork</option>
                                                        <option>Zip File</option>
                                                        <option>Thingy</option>
                                                        <option>Luigi was not here</option>
                                                    </select>
                                                </td>
                                                <td><input type="text" class="form-control" value="I Digress"></td>
                                            </tr>
                                        </tbody>
                                    </table>-->
                                    <input type='file' id="extraFiles" name="extraFiles" multiple />
                                </div>
                            </div>
                            </form>
                           <div class="publish-section publish-submit">
                                <div class="row">
                                    <div class="col-sm-9">
                                        <p class="small">You will be able to submit your video after you preview it. Be sure it looks exactly like what you desire as you will be unable to change this later.</p>
                                    </div>
                                    <div class="col-sm-3 text-right">
                                        <button type="button" id="previewButton" class="btn btn-primary">Preview</button>
                                    </div>
                                </div>
                            </div>
                            <div style='height:30px'></div>
                        </div>
                    </div>
                    <div class="tab-pane" role="tabpanel" id="step3">
                        <h3>Publishing...</h3>
                        <div>
                            <div class="loading-spinner" style="margin-top: -200px"></div>
                            <div class="well well-sm" id="publishWell" style="margin-top: 0px; height: 500px; font-family:monospace; font-size: 12px;"></div>
                        </div>
                    </div>
                    <div class="tab-pane" role="tabpanel" id="complete">
                        <h3>Complete</h3>
                        <p>You have successfully completed all steps.</p>
                    </div>
                    <div class="clearfix"></div>
                </div>
            </form>
        </div>
    </section>
   </div>
</div>
<div class="modal fade" id="newPublisherModal" tabindex="-1" role="dialog" aria-labelledby="newPublisherLabel">
    <div class="vertical-alignment-helper">
        <div class="modal-dialog vertical-align-center" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                    <h4 class="modal-title" id="newPublisherLabel">Register a new Publisher</h4>
                </div>
                <div class="modal-body">
                <div id="newPublisherLoadingDiv" style="display:none;">
                    <div class="loading-spinner"></div>
                    <div class="well well-sm" id="newPublisherLoadingWell" style="margin-top: 171px; height: 200px; font-family:monospace; font-size: 12px;"></div>
                </div>
                <div id="newPublisherFormDiv" style="display:block">
                    <form>
                      <div class="form-group">
                        <label for="newPublisherName">Publisher Name</label>
                        <input type="email" class="form-control" id="newPublisherName" placeholder="Publisher Name">
                        <p class="help-block">This is your display name for your publisher, i.e. Imogen Heap</p>
                      </div>
                      <div class="form-group">
                        <label for="newPublisherEmail">Email (optional)</label>
                        <input type="email" class="form-control" id="newPublisherEmail" placeholder="Email">
                        <p class="help-block">An MD5 hash will be generated from your email address, which will be published publicly. This is used for Gravatar’s dynamic Avatar lookup service, but your email address itself will not be published in plaintext.</p>
                      </div>
                      <div class="form-group">
                        <label for="newPublisherFlorincoinAddress">Florincoin Address</label>
                        <input type="text" class="form-control" id="newPublisherFlorincoinAddress" placeholder="FKfguRay1RMskNP2esNDr8AawBZHF1eb56">
                        <p class="help-block">This is your Florincoin address that you will use to publish items.</p>
                      </div>
                    </form>
                    <button class="btn btn-default" onclick="registerNewPublisher();">Register Publisher</button>
                </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-danger" data-dismiss="modal" onclick="return false;">Cancel</button>
                </div>
            </div>
        </div>
    </div>
</div>
<div class="modal fade" id="previewModal" tabindex="-1" role="dialog" aria-labelledby="previewLabel">
    <div class="">
        <div class="modal-dialog" role="document" style='width:95%'>
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                    <h4 class="modal-title" id="previewLabel">Preview Artifact</h4>
                </div>
                <div class="modal-body">
                    <div class="container">
                    <div class="row">
                    <div class="col-md-12">
                        <div class="row media-embed">
                        <center>
                            <video id='previewVideo' controls="controls" src="http://ipfs.alexandria.media/ipfs/QmNrcxXH9PgHzEaFTQQNQRYNvUbLZXnyKueaVUV3C94fDN/alexandria_v051alpha_demo.m4v" style="width: 80%">
                            </video>
                            </center>
                        </div>
                        <div class="row entity-meta-header">
                        <br>
                            <h2 id='previewTitle'>Alexandria v0.5.1 alpha demo</h2>
                            <h3 id="previewArtist">Alexandria Council of Librarians</h3>
                            <div class="entity-meta-content">
                                <div id='previewTime' class="entity-pub-time">Posted <span>Tue Dec 08 2015 09:36:34 GMT-0700 (MST)</span></div>
                                <div id='previewRuntime' class="entity-runtime">Runtime: <span id="entity-runtime">00:12:48</span></div>
                            </div>
                        </div>
                        <div class="row media-desc">
                            <p id='previewDescription'>Alexandria's founder, Devon Read, demos a variety of features and explains a bit more about how the Decentralized Library of Alexandria works... ProTip - One way that you can directly support Alexandria is by installing Librarian and pointing your web browser at this URL: http://localhost:8079/api/ipfs/pin/add/QmNrcxXH9PgHzEaFTQQNQRYNvUbLZXnyKueaVUV3C94fDN to pin this video locally to help decentralize it storage and distribution further.</p>
                        </div>
                    </div>
                    </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-danger pull-left" data-dismiss="modal">Cancel</button>

                    <button type="button" class="btn btn-success pull-right" data-dismiss="modal" onclick="submitArtifact()">Submit</button>
                </div>
            </div>
        </div>
    </div>
</div>
</body>

    <!-- Load external JS helper files -->
    <script src="https://code.jquery.com/jquery-1.10.2.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.0/js/bootstrap.min.js"></script>
    <script src="js/sweet-alert.min.js"></script>
    <script src="js/ipfs.js"></script>

	<script type="text/javascript">
    	$(document).ready(function () {
        //Initialize tooltips
        $('.nav-tabs > li a[title]').tooltip();
        
        //Wizard
        $('a[data-toggle="tab"]').on('show.bs.tab', function (e) {

            var $target = $(e.target);
        
            if ($target.parent().hasClass('disabled')) {
                return false;
            }
        });

        $(".next-step").click(function (e) {

            var $active = $('.wizard .nav-tabs li.active');
            $active.next().removeClass('disabled');
            nextTab($active);

        });
        $(".prev-step").click(function (e) {

            var $active = $('.wizard .nav-tabs li.active');
            prevTab($active);

        });
    });

    function nextTab(elem) {
        $(elem).next().find('a[data-toggle="tab"]').click();
    }
    function prevTab(elem) {
        $(elem).prev().find('a[data-toggle="tab"]').click();
    }

    function continueToArtifact() {
        if (document.getElementById("publisherSelect").value != 'None Registered...a'){
            var $active = $('.wizard .nav-tabs li.active');
            $active.next().removeClass('disabled');
            nextTab($active);
        } else {
            swal("Error!", "You must select a publisher address to continue!", "error");
        }
    }

    $('#previewButton').click(function(e){
        // Set all of the items in the preview.
        // Set title.
        $('#previewTitle').text($('#videoTitle').val());
        // Set Publisher
        $('#previewArtist').text($('#directorName').val());
        // Set Description
        $('#previewDescription').text($('#description').val());
        // Set Video
        try {
            var newURL = URL.createObjectURL($('#mediaFiles').prop('files')[0]);
            console.log(newURL);
            $('#previewVideo').attr('src', newURL);
        } catch(e) {
            swal('Error', 'You must select a video file.', 'error');
            return;
        }

        $('#previewModal').modal('show');
    })

    function submitArtifact(){
        swal({
          title: "Are you sure?",
          text: "You will not be able to change this later without deleting it completely!",
          type: "warning",
          showCancelButton: true,
          confirmButtonClass: "btn-success",
          confirmButtonText: "Yes, publish it!",
          closeOnConfirm: true
        },
        function(){
            var $active = $('.wizard .nav-tabs li.active');
            $active.next().removeClass('disabled');
            nextTab($active);

            publishArtifact();
        });
    }

    continueToArtifact();
	</script>

    <!-- Load custom JS files -->
    <script src="js/publisher.js"></script>
    <script src="js/publishArtifact.js"></script>
    <script src="js/dropzone.js"></script>