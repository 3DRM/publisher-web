<html lang="en"><head>
	<meta charset="utf-8">
	<meta name="robots" content="noindex">

	<title>DLOA - Publisher</title>
		<meta name="viewport" content="width=device-width, initial-scale=1">
	<link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.1/css/bootstrap.min.css" rel="stylesheet" id="bootstrap-css">

	<!-- Load css files -->
	<link href="./css/main.css" rel="stylesheet">
	<link href="./css/artifact.css" rel="stylesheet">
	<link href="./css/sweet-alert.css" rel="stylesheet">
</head>
<body>
<div class="container page-wrap">
	
	</section>
   </div>
</div>
<div class="modal fade" id="newPublisherModal" tabindex="-1" role="dialog" aria-labelledby="newPublisherLabel">
	<div class="vertical-alignment-helper">
		<div class="modal-dialog vertical-align-center" role="document">
			<div class="modal-content">
				<div class="modal-header">
					<button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
					<h4 class="modal-title" id="newPublisherLabel">Register a new Publisher</h4>
				</div>
				<div class="modal-body">
				<div id="newPublisherLoadingDiv" style="display:none;">
					<div class="loading-spinner"></div>
					<div class="well well-sm" id="newPublisherLoadingWell" style="margin-top: 171px; height: 200px; font-family:monospace; font-size: 12px;"></div>
				</div>
				<div id="newPublisherFormDiv" style="display:block">
					<form>
					  <div class="form-group" id="pubNameFormGroup">
						<label for="newPublisherName">Publisher Name</label>
						<input type="email" class="form-control" id="newPublisherName" placeholder="Publisher Name">
						<p class="help-block">This is your display name for your publisher, i.e. Imogen Heap</p>
					  </div>
					  <div class="form-group" id="pubEmailFormGroup">
						<label for="newPublisherEmail">Email (optional)</label>
						<input type="email" class="form-control" id="newPublisherEmail" placeholder="Email">
						<p class="help-block">An MD5 hash will be generated from your email address, which will be published publicly. This is used for Gravatarâ€™s dynamic Avatar lookup service, but your email address itself will not be published in plaintext.</p>
					  </div>
					  <div class="form-group" id="pubFloAddressFormGroup">
						<label for="newPublisherFlorincoinAddress">Florincoin Address</label>
						<select id="newPublisherFlorincoinAddress" class="form-control">
							<!--<option>Create new address...</option> // Disabled until Tradebot works.-->
						</select>
						<p class="help-block">This is your Florincoin address that you will use to publish items. Please note that you will need at least 1 FLO on this wallet. If you select a wallet with 0 FLO you will be prompted to buy some using Bitcoin.</p>
					  </div>
					</form>
					<button class="btn btn-default" onclick="registerNewPublisher();">Register Publisher</button>
				</div>
				</div>
				<div class="modal-footer">
					<button type="button" class="btn btn-danger" data-dismiss="modal" onclick="return false;">Cancel</button>
				</div>
			</div>
		</div>
	</div>
</div>
<div class="modal fade" id="previewModal" tabindex="-1" role="dialog" aria-labelledby="previewLabel">
	<div class="">
		<div class="modal-dialog" role="document" style='width:95%'>
			<div class="modal-content">
				<div class="modal-header">
					<button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
					<h4 class="modal-title" id="previewLabel">Preview Artifact</h4>
				</div>
				<div class="modal-body">
					<div class="container">
					<div class="row">
					<div class="col-md-12">
						<div class="row media-embed">
						<center>
							<video id='previewVideo' controls="controls" src="" style="width: 80%">
							</video>
							</center>
						</div>
						<div class="row entity-meta-header">
						<br>
							<h2 id='previewTitle'>Title</h2>
							<h3 id="previewArtist">Artist</h3>
							<div class="entity-meta-content">
								<div id='previewTime' class="entity-pub-time">Posted <span id="current-time">Tue Dec 08 2015 09:36:34 GMT-0700 (MST)</span></div>
								<div id='previewRuntime' class="entity-runtime">Runtime: <span id="runtime">00:12:48</span></div>
							</div>
						</div>
						<div class="row media-desc">
							<p id='previewDescription'>Description</p>
						</div>
					</div>
					</div>
					</div>
				</div>
				<div class="modal-footer">
					<button type="button" class="btn btn-danger pull-left" data-dismiss="modal" onclick="$('#previewVideo').get(0).pause();">Cancel</button>

					<button type="button" class="btn btn-success pull-right" data-dismiss="modal" onclick="submitArtifact()">Submit</button>
				</div>
			</div>
		</div>
	</div>
</div>
<div class="modal fade" id="walletModal" tabindex="-1" role="dialog" aria-labelledby="walletLabel">
	<div class="vertical-alignment-helper">
		<div class="vertical-align-center modal-dialog" role="document">
			<div class="modal-content">
				<div class="modal-header">
					<h4 class="modal-title" id="walletLabel">Login to Wallet</h4>
				</div>
				<div class="modal-body">
					<div class="container">
						<div class="row">
							<div class="col-md-6">
								<!-- Nav tabs -->
								<ul class="nav nav-tabs" role="tablist">
									<li role="presentation" class="active"><a href="#login" aria-controls="login" role="tab" data-toggle="tab">Login</a></li>
									<li role="presentation"><a href="#register" aria-controls="register" role="tab" data-toggle="tab">Register</a></li>
								</ul>

								<!-- Tab panes -->
								<div class="tab-content">
									<div role="tabpanel" class="tab-pane active" id="login">
										<form>
											<div class="form-group">
												<label for="loginWalletIdentifier">Wallet Identifier</label>
												<input type="text" class="form-control" id="loginWalletIdentifier" placeholder="xxxx-xxxx-xxx-xxx">
												<p class="help-block">This is your wallet identifier that you recieved after creating a wallet with Flovault.</p>
											</div>
											<div class="form-group">
												<label for="loginWalletPassword">Password</label>
												<input type="password" class="form-control" id="loginWalletPassword" placeholder="">
												<p class="help-block"></p>
											</div>
											<div class="form-group">
												<input id="login-remember" type="checkbox" name="remember" value="1"> Remember me
												<p class="help-block"></p>
											</div>
										</form>
										<button class="btn btn-success" id="walletLoginButton" onclick="loginToWallet();">Login</button>
									</div>
									<div role="tabpanel" class="tab-pane" id="register">
										<form>
											<div class="form-group">
												<label for="loginWalletIdentifier">Email Address</label>
												<input type="email" class="form-control" id="createWalletEmail" placeholder="example@me.com">
												<p class="help-block">Optional email, used for 2FA and if you forget your identifier.</p>
											</div>
											<div class="form-group">
												<label for="loginWalletPassword">Password</label>
												<input type="password" class="form-control" id="createWalletPassword" placeholder="">
												<p class="help-block">You will use this password along with your generated identifier to login to your account.</p>
											</div>
										</form>
										<button class="btn btn-success" onclick="registerWallet();">Register</button>
									</div>
								</div>
							</div>
						</div>
					</div>
				</div>
				<div class="modal-footer">
				</div>
			</div>
		</div>
	</div>
</div>
<div class="modal fade" id="walletInfoModal" tabindex="-1" role="dialog" aria-labelledby="walletInfoLabel">
	<div class="vertical-alignment-helper">
		<div class="vertical-align-center modal-dialog" role="document">
			<div class="modal-content">
				<div class="modal-header">
					<button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
					<h4 class="modal-title" id="walletInfoLabel">Wallet Info</h4>
				</div>
				<div class="modal-body">
					<div class="container">
						<div class="row">
							<div class="col-md-6">
								<!-- Nav tabs -->
								<ul class="nav nav-tabs" role="tablist">
									<li role="presentation" class="active"><a href="#main" aria-controls="main" role="tab" data-toggle="tab">Main</a></li>
								</ul>

								<!-- Tab panes -->
								<div class="tab-content">
									<div role="tabpanel" class="tab-pane active" id="main">
										<h4>Identifier <code id="identifier"></code></h4>
										<div class="table-responsive">
											<table class="table table-bordered table-condensed" id="addressTable">
												<thead>
													<tr>
														<th>Address</th>
														<th style="width: 30%">Balance</th>
														<th>Actions</th>
													</tr>
												</thead>
												<tbody>
													<tr></tr>
												</tbody>
											</table>
										</div>
										<button class="btn btn-default" onclick="newAddress();">New Address</button>
										<button class="btn btn-danger" onclick="location.reload();">Log Out</button>
									</div>
								</div>
							</div>
						</div>
					</div>
				</div>
				<div class="modal-footer">
					<button class="btn btn-danger" data-dismiss="modal" aria-label="Close">Close</button>
					<button class="btn btn-default pull-left" onclick="refreshWalletInfo();" id="refreshButton">Refresh</button>
				</div>
			</div>
		</div>
	</div>
</div>
<div class="modal fade" id="tradebotModal" tabindex="-1" role="dialog" aria-labelledby="tradebotLabel">
	<div class="vertical-alignment-helper">
		<div class="vertical-align-center modal-dialog" role="document">
			<div class="modal-content">
				<div class="modal-header">
					<button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
					<h4 class="modal-title" id="tradebotLabel">Get FLO with TradeBot</h4>
				</div>
				<div class="modal-body">
					<div class="container">
						<div class="row">
							<div class="col-md-6" id="tradebotBuy">
								<center>
									<p>Please send $<span id="usdLabel"></span> in BTC to this address. You can change this amount below.</p>
									<div id="qrcode" style="width: 80%; height: 80%;"></div>
									<br>
									<code style="font-size: 18px" id="btcDisplayAddress">1EV7zyqRK6qS2QnZdwXrgS2aKzXpi91jBn</code>
									<br>
									<br>
									<form class="form-inline">
									  <div class="form-group">
										<div class="input-group">
											<div class="input-group-addon">$</div>
											<input type="text" class="form-control" id="usdValue" placeholder="" style="width: 75px;" onblur="updateUSD()">
											<div class="input-group-addon">USD</div>
										</div>
									  </div>
									  <div class="form-group">
										<div class="input-group">
										  <input type="text" class="form-control" id="btcValue" placeholder="" style="width: 75px;" onblur="updateBTC()">
										  <div class="input-group-addon">BTC</div>
										</div>
									  </div>
									  
									  <div class="form-group">
										<div class="input-group">
											<input type="text" class="form-control" id="floValue" placeholder="" style="width: 75px;" onblur="updateFLO()">
											<div class="input-group-addon">FLO</div>
										</div>
									  </div>
									</form>
									<a class="coinbase-widget" id="coinbase_widget" href="">Buy FLO with Debit/Credit</a>
								</center>
							</div>
							<div class="col-md-6" id="tradebotPending" style="opacity: 0; display: none;">
								<center>
									<p style="padding-top: 20px;">Bitcoin transaction recieved... waiting for Tradebot to send funds...</p>
								</center>
								<div id="loading">
									<ul class="bokeh">
										<li></li>
										<li></li>
										<li></li>
									</ul>
								</div>
								<center>
									<p style="padding-top: -50px;">This usually takes 5-10 minutes depending on Bitcoin block times and Tradebot response times.</p>
								</center>
							</div>
						</div>
					</div>
				</div>
				<div class="modal-footer">
					<button type="button" class="btn btn-danger pull-right" data-dismiss="modal" onclick="cancelFloBuy()">Cancel</button>
				</div>
			</div>
		</div>
	</div>
	<video src="" width="1" height="1" id="video_player"></video>
</div>
<footer class="footer navbar-fixed-bottom">
	<div class="container sticky-footer-container">
		<p class="sticky-footer-text-muted" id="footerText"></p>
	</div>
</footer>
</body>

	<!-- Load external JS helper files -->
	<script src="https://code.jquery.com/jquery-1.10.2.min.js"></script>
	<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.0/js/bootstrap.min.js"></script>
	<!-- Wallet JS -->
	<script src="js/SimpleDeps.js"></script>
	<script src="js/SimpleWallet.js"></script>
	<script src="js/libraryd-js.js"></script>
	<script src="js/wallet.js"></script>
	<!-- Other JS -->
	<script src="js/dropzone.js"></script>
	<script src="js/sweet-alert.min.js"></script>
	<script src="js/date-format.js"></script>
	<script src="js/ipfs.js"></script>
	<script src="js/qrcode.min.js"></script>
	<script src="js/coinbase.js"></script>
	<script src="js/tradebot.js"></script>
	<script src="js/createPublisher.js"></script>
	<script src="js/publishArtifact.js"></script>

	<!-- Visual JS -->
	<script type="text/javascript">
	// Set the version number in the footer
	var version = "0.7.9";
	document.getElementById("footerText").innerHTML = "Alexandria Web Publisher v" + version + " - Questions? Comments? Want to Help? Join us on our <a href='http://dloaslack.bitspill.net/'>Slack chat</a>!";

	$(document).ready(function () {
		//Initialize
		$('.nav-tabs > li a[title]').tooltip();
		$('#pricing').hide();
		$('#mediaFilesTable').hide();
		$('#extraTable').hide();
		
		//Wizard
		$('a[data-toggle="tab"]').on('show.bs.tab', function (e) {

			var $target = $(e.target);
		
			if ($target.parent().hasClass('disabled')) {
				return false;
			}
		});

		$(".next-step").click(function (e) {

			var $active = $('.wizard .nav-tabs li.active');
			$active.next().removeClass('disabled');
			nextTab($active);

		});
		$(".prev-step").click(function (e) {

			var $active = $('.wizard .nav-tabs li.active');
			prevTab($active);

		});
	});

	function nextTab(elem) {
		$(elem).next().find('a[data-toggle="tab"]').click();
	}
	function prevTab(elem) {
		$(elem).prev().find('a[data-toggle="tab"]').click();
	}

	$('#login a').click(function (e) {
		e.preventDefault()
		$(this).tab('show');
	})
	$('#register a').click(function (e) {
		e.preventDefault()
		$(this).tab('show');
	})

	$("#loginWalletPassword").keyup(function(event){
		if(event.keyCode == 13){
			$("#walletLoginButton").click();
		}
	});

	function fade(element) {
		var op = 1;  // initial opacity
		var timer = setInterval(function () {
			if (op <= 0.1){
				clearInterval(timer);
				element.style.display = 'none';
			}
			element.style.opacity = op;
			element.style.filter = 'alpha(opacity=' + op * 100 + ")";
			op -= op * 0.1;
		}, 20);
	}

	function unfade(element) {
		var op = 0.01;  // initial opacity
		element.style.display = 'block';
		var timer = setInterval(function () {
			if (op >= 1){
				clearInterval(timer);
			}
			element.style.opacity = op;
			element.style.filter = 'alpha(opacity=' + op * 100 + ")";
			op += op * 0.1;
		}, 15);
	}

	function changeArtifactType(mediaType){
		// Remove all media files when artifact type is changed.
		$('.mediaRow').each(function(){
			$(this).find('.btn-danger').click();
		});
		// Change supported files to be uploaded
		// Get type in order to validate files
		if (mediaType == 'video'){
			mediaType = 'video/*';
		}
		else if (mediaType == 'music'){
			mediaType = 'audio/*';
		}
		else if (mediaType == 'podcast'){
			mediaType = 'audio/*';
		}
		else if (mediaType == 'book'){
			mediaType = 'application/pdf,text/*';
		}
		else if (mediaType == 'movie'){
			mediaType = 'video/*';
		}
		else if (mediaType == 'thing'){
			mediaType = '*/*';
		}
		else if (mediaType == 'html'){
			mediaType = '*/*';
		}

		$('#mediaFiles').attr('accept', mediaType);
	}

	function next(){
		var $active = $('.wizard .nav-tabs li.active');
		$active.next().removeClass('disabled');
		nextTab($active);
	}

	// Hide the coinbase buy button if not on alexandria.io as it will not work
	testDomain();

    $('#walletModal').modal('show');
	</script>